# 📧 快速配置邮箱推送 - 3 步完成

## 🎯 目标

配置邮箱地址，接收每日 AI 新闻摘要推送，查看系统输出效果。

## ⚡ 快速开始（3 步）

### 步骤 1: 注册 Resend 并获取 API Key（5 分钟）

1. **访问** https://resend.com/
2. **点击 "Sign Up"** 注册账号（可以用 GitHub 登录）
3. **验证邮箱**
4. **进入控制台** → **API Keys** → **Create API Key**
5. **复制 API Key**（格式：`re_xxxxxxxxxxxxx`）

### 步骤 2: 修改配置文件（2 分钟）

```bash
cd /Users/pingxn7/Desktop/x/backend
nano .env
```

找到并修改这 3 行：

```bash
# 将这行
RESEND_API_KEY=your-resend-api-key-here
# 改为（替换为您的 API Key）
RESEND_API_KEY=re_你的API_Key

# 将这行
EMAIL_FROM=noreply@yourdomain.com
# 改为（使用 Resend 测试域名）
EMAIL_FROM=onboarding@resend.dev

# 将这行
EMAIL_TO=your-email@example.com
# 改为（您的邮箱地址）
EMAIL_TO=你的邮箱@gmail.com
```

保存并退出：`Ctrl+X` → `Y` → `Enter`

### 步骤 3: 测试邮件发送（1 分钟）

```bash
cd /Users/pingxn7/Desktop/x/backend
source venv/bin/activate
python scripts/test_email.py
```

## 📧 您将收到的邮件

### 邮件标题
```
AI News Digest - 2026-02-08 | 今日精选10条
```

### 邮件内容
- 🎨 **精美的 HTML 邮件**
- 📌 **今日关键亮点** - AI 领域重要进展总结
- 🔥 **今日精选** - Top 10 最重要的推文
  - 账号名称和推文摘要
  - 互动数据（👍 点赞 🔄 转发 💬 回复）
- 🔗 **查看完整汇总** - 链接到前端页面
- 📊 **统计信息** - 收集的推文总数

## ⏰ 自动发送时间

当前配置：
```
每天早上 8:00 (UTC) = 北京时间 16:00（下午 4 点）
```

**如果想改为北京时间早上 8 点：**

编辑 `.env` 文件：
```bash
# 将这行
SCHEDULE_DAILY_SUMMARY_CRON=0 8 * * *
# 改为
SCHEDULE_DAILY_SUMMARY_CRON=0 0 * * *
```

## 🔧 一键配置命令

如果您已经有了 Resend API Key，可以使用这个命令快速配置：

```bash
cd /Users/pingxn7/Desktop/x/backend

# 替换为您的实际值
export RESEND_KEY="re_your_api_key"
export YOUR_EMAIL="your-email@gmail.com"

# 一键配置
sed -i '' "s/RESEND_API_KEY=.*/RESEND_API_KEY=$RESEND_KEY/" .env
sed -i '' 's/EMAIL_FROM=.*/EMAIL_FROM=onboarding@resend.dev/' .env
sed -i '' "s/EMAIL_TO=.*/EMAIL_TO=$YOUR_EMAIL/" .env

# 验证配置
grep -E "RESEND_API_KEY|EMAIL_FROM|EMAIL_TO" .env
```

## ✅ 验证配置

运行测试脚本：

```bash
cd /Users/pingxn7/Desktop/x/backend
source venv/bin/activate
python scripts/test_email.py
```

测试脚本会：
1. ✓ 检查邮件配置是否正确
2. ✓ 查询数据库中的摘要和推文
3. ✓ 发送测试邮件到您的邮箱
4. ✓ 显示发送结果

## 🎯 预期输出

```
================================================================================
AI News Collector - 邮件发送测试
================================================================================

检查邮件配置...
  邮件功能启用: True
  Resend API Key: 已配置
  发件人: onboarding@resend.dev
  收件人: your-email@gmail.com

✓ 邮件配置检查通过

查询数据库中的摘要...
✓ 找到摘要: 2026-02-08
  推文总数: 15
  精选推文: 10

获取精选推文...
✓ 找到 10 条精选推文

================================================================================
发送测试邮件...
================================================================================

发件人: onboarding@resend.dev
收件人: your-email@gmail.com
主题: AI News Digest - 2026-02-08 | 今日精选10条

================================================================================
✓ 邮件发送成功！

请检查您的邮箱：your-email@gmail.com
如果没有收到，请检查垃圾邮件文件夹
================================================================================
```

## 🆘 常见问题

### Q: 我没有收到邮件？

**检查清单：**
1. ✓ 检查垃圾邮件文件夹
2. ✓ 确认 RESEND_API_KEY 配置正确
3. ✓ 确认 EMAIL_TO 是您的邮箱地址
4. ✓ 等待 1-2 分钟（邮件可能有延迟）

### Q: 测试脚本报错？

**可能原因：**
- API Key 配置错误
- 数据库中没有推文数据
- Resend 服务问题

**解决方法：**
查看错误信息，根据提示修改配置

### Q: 如何修改邮件发送时间？

编辑 `.env` 文件中的 `SCHEDULE_DAILY_SUMMARY_CRON`

**常用时间配置：**
```bash
# 每天早上 8:00 (UTC)
SCHEDULE_DAILY_SUMMARY_CRON=0 8 * * *

# 每天早上 8:00 (北京时间)
SCHEDULE_DAILY_SUMMARY_CRON=0 0 * * *

# 每天晚上 20:00 (北京时间)
SCHEDULE_DAILY_SUMMARY_CRON=0 12 * * *
```

### Q: 可以发送到多个邮箱吗？

目前只支持单个邮箱。如需多个邮箱，需要修改代码。

## 💡 Resend 免费额度

- **每月 3,000 封邮件**
- **每天 100 封邮件**
- **无需信用卡**
- **足够个人使用**

## 📊 邮件发送流程

```
1. 系统每天自动收集推文（每 2 小时）
   ↓
2. 每天早上 8:00 (UTC) 生成摘要
   ↓
3. 使用 Claude 分析推文，提取关键信息
   ↓
4. 生成精美的 HTML 邮件
   ↓
5. 通过 Resend 发送到您的邮箱
   ↓
6. 您收到邮件，查看 AI 新闻摘要
```

## 🎯 下一步

**现在您可以：**

**选项 1: 立即配置邮箱**
- 注册 Resend
- 修改 .env 配置
- 运行测试脚本

**选项 2: 我需要帮助**
- 告诉我您遇到的问题
- 我会详细指导您

**选项 3: 我想看邮件效果**
- 配置好后运行测试脚本
- 立即收到测试邮件

---

**需要帮助？**

- 查看 `配置邮箱推送.md` 获取详细说明
- 运行 `python scripts/test_email.py` 测试邮件发送
- 告诉我您的邮箱地址，我帮您生成配置命令

**您想现在配置邮箱吗？** 告诉我您的邮箱地址，我会帮您生成完整的配置命令！
